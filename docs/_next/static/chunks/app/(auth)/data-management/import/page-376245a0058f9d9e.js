(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[351],{67156:(e,t,n)=>{Promise.resolve().then(n.bind(n,39227))},39227:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eo});var r=n(95155),a=n(99373),i=n(71349),o=n(68773),l=n(24907),s=n(21614),d=n(55474),c=n(99907),p=n(56254),u=n(12115),m=n(6828);let h=JSON.parse('{"p":[{"key":1,"patientId":"P202400001","age":32,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":1,"ramsayScore":2,"muscleStrength":0},{"key":2,"patientId":"P202400002","age":31,"pumpFlow":2.8,"sufentanil":65,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":3,"patientId":"P202400003","age":31,"pumpFlow":3.2,"sufentanil":75,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":102,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":4,"patientId":"P202400004","age":25,"pumpFlow":2.9,"sufentanil":68,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":97,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":5,"patientId":"P202400005","age":40,"pumpFlow":3.1,"sufentanil":72,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":103,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":6,"patientId":"P202400006","age":39,"pumpFlow":2.7,"sufentanil":67,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":96,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":7,"patientId":"P202400007","age":34,"pumpFlow":3.3,"sufentanil":73,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":104,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":8,"patientId":"P202400008","age":37,"pumpFlow":3,"sufentanil":69,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":99,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":9,"patientId":"P202400009","age":33,"pumpFlow":2.8,"sufentanil":66,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":97,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":10,"patientId":"P202400010","age":37,"pumpFlow":3.2,"sufentanil":74,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":101,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":11,"patientId":"P202400011","age":30,"pumpFlow":3.1,"sufentanil":71,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":102,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":12,"patientId":"P202400012","age":32,"pumpFlow":2.9,"sufentanil":68,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":99,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":13,"patientId":"P202400013","age":26,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":1,"ramsayScore":2,"muscleStrength":0},{"key":14,"patientId":"P202400014","age":31,"pumpFlow":2.8,"sufentanil":67,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":15,"patientId":"P202400015","age":34,"pumpFlow":3.2,"sufentanil":73,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":103,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":16,"patientId":"P202400016","age":35,"pumpFlow":2.7,"sufentanil":65,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":96,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":17,"patientId":"P202400017","age":31,"pumpFlow":3.3,"sufentanil":75,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":105,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":18,"patientId":"P202400018","age":35,"pumpFlow":3,"sufentanil":69,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":19,"patientId":"P202400019","age":33,"pumpFlow":2.9,"sufentanil":68,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":20,"patientId":"P202400020","age":27,"pumpFlow":3.1,"sufentanil":72,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":101,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":21,"patientId":"P202400021","age":36,"pumpFlow":2.8,"sufentanil":66,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":97,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":22,"patientId":"P202400022","age":33,"pumpFlow":3.2,"sufentanil":74,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":104,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":23,"patientId":"P202400023","age":32,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":1,"ramsayScore":2,"muscleStrength":0},{"key":24,"patientId":"P202400024","age":26,"pumpFlow":2.9,"sufentanil":69,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":99,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":25,"patientId":"P202400025","age":33,"pumpFlow":3.1,"sufentanil":71,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":102,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":26,"patientId":"P202400026","age":39,"pumpFlow":2.7,"sufentanil":65,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":95,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":27,"patientId":"P202400027","age":36,"pumpFlow":3.3,"sufentanil":75,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":105,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":28,"patientId":"P202400028","age":37,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":29,"patientId":"P202400029","age":30,"pumpFlow":2.8,"sufentanil":67,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":30,"patientId":"P202400030","age":37,"pumpFlow":3.2,"sufentanil":73,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":103,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":31,"patientId":"P202400031","age":26,"pumpFlow":3,"sufentanil":71,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":101,"vasScore":2,"ponvGrade":1,"ramsayScore":2,"muscleStrength":0},{"key":32,"patientId":"P202400032","age":32,"pumpFlow":2.9,"sufentanil":67,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":33,"patientId":"P202400033","age":37,"pumpFlow":3.1,"sufentanil":73,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":103,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":34,"patientId":"P202400034","age":31,"pumpFlow":2.8,"sufentanil":66,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":97,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":35,"patientId":"P202400035","age":40,"pumpFlow":3.2,"sufentanil":74,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":104,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":36,"patientId":"P202400036","age":38,"pumpFlow":2.7,"sufentanil":65,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":96,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":37,"patientId":"P202400037","age":40,"pumpFlow":3.3,"sufentanil":75,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":105,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":38,"patientId":"P202400038","age":30,"pumpFlow":3,"sufentanil":69,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":99,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":39,"patientId":"P202400039","age":29,"pumpFlow":2.9,"sufentanil":68,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":40,"patientId":"P202400040","age":40,"pumpFlow":3.1,"sufentanil":72,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":102,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":41,"patientId":"P202400041","age":34,"pumpFlow":2.8,"sufentanil":66,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":97,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":42,"patientId":"P202400042","age":35,"pumpFlow":3.2,"sufentanil":74,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":104,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":43,"patientId":"P202400043","age":29,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":1,"ramsayScore":2,"muscleStrength":0},{"key":44,"patientId":"P202400044","age":34,"pumpFlow":2.9,"sufentanil":68,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":99,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":45,"patientId":"P202400045","age":29,"pumpFlow":3.1,"sufentanil":73,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":103,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":46,"patientId":"P202400046","age":28,"pumpFlow":2.7,"sufentanil":65,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":95,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":47,"patientId":"P202400047","age":31,"pumpFlow":3.3,"sufentanil":75,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":105,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":48,"patientId":"P202400048","age":26,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":1,"ramsayScore":2,"muscleStrength":0},{"key":49,"patientId":"P202400049","age":31,"pumpFlow":2.8,"sufentanil":67,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":50,"patientId":"P202400050","age":31,"pumpFlow":3.2,"sufentanil":74,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":104,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":51,"patientId":"P202400051","age":29,"pumpFlow":3.1,"sufentanil":72,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":102,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":52,"patientId":"P202400052","age":30,"pumpFlow":2.9,"sufentanil":68,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":99,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":53,"patientId":"P202400053","age":31,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":54,"patientId":"P202400054","age":25,"pumpFlow":2.8,"sufentanil":66,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":97,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":55,"patientId":"P202400055","age":33,"pumpFlow":3.2,"sufentanil":73,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":103,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":56,"patientId":"P202400056","age":37,"pumpFlow":2.7,"sufentanil":65,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":96,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":57,"patientId":"P202400057","age":33,"pumpFlow":3.3,"sufentanil":75,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":105,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":58,"patientId":"P202400058","age":33,"pumpFlow":3,"sufentanil":69,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":99,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":59,"patientId":"P202400059","age":26,"pumpFlow":2.9,"sufentanil":68,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":60,"patientId":"P202400060","age":38,"pumpFlow":3.1,"sufentanil":72,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":102,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":61,"patientId":"P202400061","age":35,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":62,"patientId":"P202400062","age":34,"pumpFlow":2.8,"sufentanil":67,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":63,"patientId":"P202400063","age":31,"pumpFlow":3.2,"sufentanil":73,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":103,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":64,"patientId":"P202400064","age":29,"pumpFlow":2.9,"sufentanil":68,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":99,"vasScore":2,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":65,"patientId":"P202400065","age":25,"pumpFlow":3.1,"sufentanil":71,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":101,"vasScore":1,"ponvGrade":1,"ramsayScore":2,"muscleStrength":0},{"key":66,"patientId":"P202400066","age":29,"pumpFlow":2.7,"sufentanil":65,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":95,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":67,"patientId":"P202400067","age":37,"pumpFlow":3.3,"sufentanil":75,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":105,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1},{"key":68,"patientId":"P202400068","age":35,"pumpFlow":3,"sufentanil":70,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":100,"vasScore":2,"ponvGrade":1,"ramsayScore":2,"muscleStrength":0},{"key":69,"patientId":"P202400069","age":34,"pumpFlow":2.8,"sufentanil":67,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":98,"vasScore":3,"ponvGrade":0,"ramsayScore":2,"muscleStrength":0},{"key":70,"patientId":"P202400070","age":38,"pumpFlow":3.2,"sufentanil":74,"flurbiprofen":250,"pentazocine":90,"ondansetron":24,"dexmedetomidine":104,"vasScore":1,"ponvGrade":1,"ramsayScore":3,"muscleStrength":1}]}'),f=[{title:"患者ID",dataIndex:"patientId",type:"categorical",description:"患者唯一标识"},{title:"年龄",dataIndex:"age",type:"numeric",description:"连续数值变量(25-40岁)"},{title:"泵流量",dataIndex:"pumpFlow",type:"numeric",description:"连续数值变量(2.7-3.3ml/h)"},{title:"舒芬太尼剂量",dataIndex:"sufentanil",type:"numeric",description:"连续数值变量(65-75μg)"},{title:"氯比洛芬酯剂量",dataIndex:"flurbiprofen",type:"numeric",description:"固定剂量(250mg)"},{title:"喷他佐辛剂量",dataIndex:"pentazocine",type:"numeric",description:"固定剂量(90mg)"},{title:"昂丹司琼剂量",dataIndex:"ondansetron",type:"numeric",description:"固定剂量(24mg)"},{title:"右美托咪定剂量",dataIndex:"dexmedetomidine",type:"numeric",description:"连续数值变量(95-105μg)"},{title:"VAS疼痛评分",dataIndex:"vasScore",type:"numeric",description:"有序分类变量(1-3分)"},{title:"PONV分级",dataIndex:"ponvGrade",type:"numeric",description:"有序分类变量(0-1级)"},{title:"Ramsay镇静评分",dataIndex:"ramsayScore",type:"numeric",description:"有序分类变量(2-3分)"},{title:"肌力评分",dataIndex:"muscleStrength",type:"numeric",description:"有序分类变量(0-1分)"}],y={DATA_SELECTION:"selection",PREPROCESSING:"preprocessing",FEATURE_ANALYSIS:"feature",DISTRIBUTION:"distribution",PREVIEW:"preview"},g=(0,n(99827).v)((e,t)=>({rawData:[],selectedColumns:[],fieldConfigs:{},processedData:[],dependentVariable:null,independentVariables:[],featureImportance:{},correlationMatrix:{},transform:null,currentStep:"DATA_SELECTION",featureAnalysis:{dependentVariable:null,independentVariables:[]},distribution:{dependentVariable:null,independentVariables:[]},setRawData:t=>e({rawData:t,selectedColumns:[],fieldConfigs:{},processedData:[]}),setSelectedColumns:t=>e({selectedColumns:t}),updateFieldConfig:(t,n,r)=>e(e=>({fieldConfigs:{...e.fieldConfigs,[t]:{...e.fieldConfigs[t],field:t,[n]:r||void 0}}})),setProcessedData:t=>e({processedData:t}),setDependentVariable:t=>e({dependentVariable:t}),setIndependentVariables:t=>e({independentVariables:t}),setFeatureImportance:t=>e({featureImportance:t}),setCorrelationMatrix:t=>e({correlationMatrix:t}),resetStore:()=>e({selectedColumns:[],fieldConfigs:{},processedData:[],dependentVariable:null,independentVariables:[]}),initiateTransform:(t,n)=>{e({transform:{variable:t,type:n,isModalVisible:!1},currentStep:"PREPROCESSING"})},cancelTransform:()=>{e({transform:null})},applyTransform:()=>{let{transform:n,processedData:r,setProcessedData:a}=t();if(n&&r&&r.length)try{let t=r.map(e=>{if(!e||"object"!=typeof e)return e;let t=e[n.variable];return null==t?e:{...e,[n.variable]:function(e,t){if(isNaN(e))return e;try{switch(t){case"log":return Math.log(Math.max(e,1e-4));case"exp":return Math.exp(e);case"square":return e*e;case"sqrt":return Math.sqrt(Math.abs(e));case"standardize":default:return e;case"box-cox":if(e<=0)return Math.log(1e-4);return(Math.pow(e,.5)-1)/.5}}catch(n){return console.error("转换出错:",n,{value:e,type:t}),e}}(Number(t),n.type)}});a(t),e({transform:null})}catch(e){console.error("Error applying transformation:",e)}},setCurrentStep:t=>e({currentStep:t}),setFeatureAnalysisVariables:(t,n)=>e(e=>({featureAnalysis:{dependentVariable:t,independentVariables:n},distribution:e.distribution.dependentVariable?e.distribution:{dependentVariable:t,independentVariables:n}})),setDistributionVariables:(t,n)=>e(e=>({distribution:{dependentVariable:t,independentVariables:n},featureAnalysis:e.featureAnalysis.dependentVariable?e.featureAnalysis:{dependentVariable:t,independentVariables:n}}))}));var x=n(40144),v=n(34810),S=n(97172),b=n(8413);let j=e=>{let{onNext:t}=e,{rawData:n,selectedColumns:a,setSelectedColumns:s}=g(),d=[{key:"1",label:"选择数据列",children:(0,r.jsx)(x.A,{rowSelection:{type:"checkbox",selectedRowKeys:a,onChange:s},columns:[{title:"列名",dataIndex:"title",key:"title"},{title:"数据类型",dataIndex:"type",key:"type",render:(e,t)=>(0,r.jsxs)(o.A,{children:[e,(0,r.jsx)(v.A,{title:t.description,children:(0,r.jsx)(S.A,{})})]})},{title:"数据预览",key:"preview",render:(e,t)=>{let r=n.map(e=>e[t.dataIndex]);return"".concat(r.slice(0,3).join(", "),"...")}}],dataSource:f.map(e=>({...e,key:e.dataIndex})),pagination:!1,size:"small"})},{key:"2",label:"原始数据预览",children:(()=>{let e=Object.keys(n[0]||{}).map(e=>{var t;return{title:(null===(t=f.find(t=>t.dataIndex===e))||void 0===t?void 0:t.title)||e,dataIndex:e,key:e,width:150,render:e=>"number"==typeof e?e.toString():e}});return(0,r.jsx)(x.A,{columns:e,dataSource:n.map((e,t)=>({...e,key:t})),scroll:{x:"max-content",y:400},pagination:{pageSize:10},size:"small"})})()}];return(0,r.jsx)(i.A,{children:(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(c.A,{items:d}),a.length>0&&(0,r.jsxs)(l.Ay,{type:"primary",icon:(0,r.jsx)(b.A,{}),onClick:t,style:{marginTop:16},children:["开始预处理 (",a.length,"个字段)"]})]})})};class A{static zscore(e){let t=e.reduce((e,t)=>e+t,0)/e.length,n=Math.sqrt(e.reduce((e,n)=>e+Math.pow(n-t,2),0)/e.length)||1;return{transform:e=>Number(((e-t)/n).toFixed(3)),stats:{mean:t,std:n},description:"Z-score标准化 (μ=".concat(t.toFixed(2),", σ=").concat(n.toFixed(2),")")}}static minmax(e){let t=Math.min(...e),n=Math.max(...e),r=n-t||1;return{transform:e=>Number(((e-t)/r).toFixed(3)),stats:{min:t,max:n,range:r},description:"Min-Max归一化 (min=".concat(t,", max=").concat(n,")")}}static log(){return{transform:e=>Number(Math.log(Math.max(e,0)+1).toFixed(3)),stats:{},description:"对数转换 (log(x + 1))"}}static processData(e,t){let n=JSON.parse(JSON.stringify(e)),r={};return Object.entries(t).forEach(e=>{var t,a,i;let[o,l]=e;if(!l)return;let s=null===(t=f.find(e=>e.dataIndex===o))||void 0===t?void 0:t.type,d=n.map(e=>e[o]);if((null===(a=l.basicProcessing)||void 0===a?void 0:a.length)>0){if(l.basicProcessing.includes("removeMissing")&&(n=n.filter(e=>null!=e[o]&&""!==e[o])),l.basicProcessing.includes("removeDuplicates")){let e=new Set;n=n.filter(t=>{let n="".concat(o,"-").concat(t[o]);return!e.has(n)&&(e.add(n),!0)})}if(l.basicProcessing.includes("handleOutliers")&&"numeric"===s){let e=n.map(e=>Number(e[o])),t=this.quantile(e,.25),r=this.quantile(e,.75),a=r-t,i=t-1.5*a,l=r+1.5*a;n=n.filter(e=>{let t=Number(e[o]);return t>=i&&t<=l})}}if("numeric"===s&&(null===(i=l.numericProcessing)||void 0===i?void 0:i.length)>0){let e=n.map(e=>Number(e[o]));r[o]={},l.numericProcessing.forEach(t=>{let a=this[t](e),i="zscore"===t?"标准化":"minmax"===t?"归一化":"log"===t?"对数":"";n.forEach(e=>{e["".concat(o,"_").concat(i)]=a.transform(Number(e[o]))}),r[o][t]={...a.stats,description:a.description}})}if("categorical"===s&&l.categoricalProcessing){let e=[...new Set(d)];switch(r[o]={categories:e,count:e.length},l.categoricalProcessing){case"oneHot":e.forEach(e=>{n.forEach(t=>{t["".concat(o,"_").concat(e)]=t[o]===e?1:0})}),n.forEach(e=>delete e[o]);break;case"label":let t=e.reduce((e,t,n)=>(e[t]=n,e),{});n.forEach(e=>{e["".concat(o,"_encoded")]=t[e[o]]}),r[o].mapping=t;break;case"effect":let a=e.length;n.forEach(t=>{e.slice(0,a-1).forEach(n=>{t["".concat(o,"_").concat(n)]=t[o]===n?1:t[o]===e[a-1]?-1:0})}),n.forEach(e=>delete e[o])}}}),{data:n,stats:r}}static calculateStats(e,t){let n=e.map(e=>Number(e[t])).filter(e=>!isNaN(e)),r=n.reduce((e,t)=>e+t,0)/n.length,a=Math.sqrt(n.reduce((e,t)=>e+Math.pow(t-r,2),0)/n.length),i=n.reduce((e,t)=>e+Math.pow((t-r)/a,3),0)/n.length,o=n.reduce((e,t)=>e+Math.pow((t-r)/a,4),0)/n.length-3;return{mean:r,std:a,min:Math.min(...n),max:Math.max(...n),count:n.length,skewness:i,kurtosis:o,isNormal:1>Math.abs(i)&&2>Math.abs(o)}}static quantile(e,t){let n=[...e].sort((e,t)=>e-t),r=(n.length-1)*t,a=Math.floor(r);return void 0!==n[a+1]?n[a]+(r-a)*(n[a+1]-n[a]):n[a]}}let w=[{label:"删除缺失值",value:"removeMissing"},{label:"删除重复值",value:"removeDuplicates"},{label:"处理异常值",value:"handleOutliers"}],I=[{label:"Z-score标准化",value:"zscore"},{label:"Min-Max归一化",value:"minmax"},{label:"对数转换",value:"log"}],k=[{label:"独热编码(One-Hot)",value:"oneHot"},{label:"标签编码(Label)",value:"label"},{label:"效应编码(Effect)",value:"effect"}],F=(0,u.forwardRef)((e,t)=>{let{onNext:n}=e,{selectedColumns:a,transform:d,fieldConfigs:c,rawData:p,updateFieldConfig:m,setProcessedData:h}=g();(0,u.useImperativeHandle)(t,()=>({initiateTransform:(e,t)=>{e&&t&&y(e,"numericProcessing",[t])}})),(0,u.useEffect)(()=>{d&&y(d.variable,"numericProcessing",[d.type])},[d]);let y=(e,t,n)=>{m(e,t,n);let r={...c,[e]:{...c[e],[t]:n}};h(A.processData(p,r).data)},x={style:{width:"100%"}};return(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[a.map(e=>{var t,n,a;let l=f.find(t=>t.dataIndex===e),d=(null==l?void 0:l.type)==="numeric",p=(null==l?void 0:l.type)==="categorical";return(0,r.jsx)(i.A,{title:null==l?void 0:l.title,size:"small",children:(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(s.A,{...x,mode:"multiple",placeholder:"基础处理",options:w,value:null===(t=c[e])||void 0===t?void 0:t.basicProcessing,onChange:t=>y(e,"basicProcessing",t)}),d&&(0,r.jsx)(s.A,{...x,mode:"multiple",placeholder:"数值处理",options:I,value:null===(n=c[e])||void 0===n?void 0:n.numericProcessing,onChange:t=>y(e,"numericProcessing",t)}),p&&(0,r.jsx)(s.A,{...x,placeholder:"分类处理",options:k,value:null===(a=c[e])||void 0===a?void 0:a.categoricalProcessing,onChange:t=>y(e,"categoricalProcessing",t)})]})},e)}),a.length>0&&(0,r.jsx)(l.Ay,{type:"primary",icon:(0,r.jsx)(b.A,{}),onClick:n,style:{marginTop:16},children:"开始特征分析"})]})});F.displayName="DataPreprocessor";var P=n(87014),N=n(89351),z=n(19445);let M=e=>{let{onAnalyze:t}=e,{selectedColumns:n,featureAnalysis:a,setFeatureAnalysisVariables:d}=g();return(0,r.jsx)(i.A,{title:"变量选择",children:(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(s.A,{placeholder:"选择因变量",style:{width:"100%"},options:n.map(e=>({label:e,value:e})),value:a.dependentVariable,onChange:e=>{d(e,a.independentVariables.filter(t=>t!==e))}}),(0,r.jsx)(s.A,{mode:"multiple",placeholder:"选择自变量",style:{width:"100%"},options:n.map(e=>({label:e,value:e})),value:a.independentVariables,onChange:e=>{d(a.dependentVariable,e.filter(e=>e!==a.dependentVariable))}}),(0,r.jsx)(l.Ay,{type:"primary",icon:(0,r.jsx)(z.A,{}),onClick:t,disabled:!a.dependentVariable||0===a.independentVariables.length,children:"开始分析"})]})})};var E=n(45100),G=n(67495);let C=e=>{let t=Math.abs(e);return t>=.8?{text:"极强",color:"red"}:t>=.6?{text:"强",color:"orange"}:t>=.4?{text:"中等",color:"blue"}:t>=.2?{text:"弱",color:"green"}:{text:"极弱",color:"gray"}},V=()=>{let{processedData:e,featureAnalysis:t}=g(),{dependentVariable:n,independentVariables:a}=t,[l,d]=(0,u.useState)([a[0]]),c=(0,u.useMemo)(()=>(null==e?void 0:e.length)&&n?e.filter(e=>!!(e&&"object"==typeof e&&Number.isFinite(Number(e[n])))):[],[e,n]),p=(0,u.useMemo)(()=>c.length&&(null==l?void 0:l.length)?l.map(e=>{try{let t=function(e,t,n){try{let r=e.map(e=>({v1:"string"==typeof e[t]?parseFloat(e[t]):Number(e[t]),v2:"string"==typeof e[n]?parseFloat(e[n]):Number(e[n])})).filter(e=>!isNaN(e.v1)&&!isNaN(e.v2));if(r.length<2)return 0;let a=r.map(e=>e.v1),i=r.map(e=>e.v2),o=a.reduce((e,t)=>e+t,0)/a.length,l=i.reduce((e,t)=>e+t,0)/i.length,s=a.reduce((e,t,n)=>e+(t-o)*(i[n]-l),0),d=Math.sqrt(a.reduce((e,t)=>e+Math.pow(t-o,2),0)),c=Math.sqrt(i.reduce((e,t)=>e+Math.pow(t-l,2),0));if(0===d||0===c)return 0;return Math.max(-1,Math.min(1,s/(d*c)))}catch(e){return console.error("计算相关系数时出错:",e),0}}(c,n,e),r=Number.isFinite(t)?t:0,{text:a,color:i}=C(r);return{variable:e,correlation:r,strength:a,color:i,direction:r>0?"正相关":"负相关"}}catch(t){return console.error("Error calculating correlation for ".concat(e,":"),t),{variable:e,correlation:0,strength:"无效",color:"gray",direction:"-"}}}).sort((e,t)=>Math.abs(t.correlation)-Math.abs(e.correlation)):[],[c,l,n]),m={data:c,xField:n,yField:l[0],size:5,shape:"circle",pointStyle:{fillOpacity:.8,stroke:"#fff"},meta:{[n]:{alias:"因变量"},[l[0]]:{alias:"自变量"}}},h=[{title:"变量",dataIndex:"variable",key:"variable"},{title:"相关系数",dataIndex:"correlation",key:"correlation",render:e=>(0,r.jsxs)(E.A,{color:C(e).color,children:[e>0?"+":"",e.toFixed(3)]}),sorter:(e,t)=>Math.abs(t.correlation)-Math.abs(e.correlation)},{title:"相关性强度",key:"strength",render:(e,t)=>(0,r.jsxs)(o.A,{children:[(0,r.jsx)(E.A,{color:t.color,children:t.strength}),(0,r.jsx)("span",{children:t.direction})]})}];return c.length?(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(i.A,{title:"变量相关性分析",children:(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(s.A,{mode:"multiple",style:{width:"100%"},value:l,onChange:d,options:a.map(e=>({label:e,value:e})),placeholder:"选择要分析的自变量（可多选）"}),(0,r.jsx)(P.A,{message:'与因变量 "'.concat(n,'" 的相关性分析'),type:"info",showIcon:!0}),1===l.length?(0,r.jsxs)(r.Fragment,{children:[p[0]&&(0,r.jsx)(P.A,{message:(0,r.jsxs)(o.A,{children:[(0,r.jsx)("span",{children:"相关性分析结果："}),(0,r.jsx)(E.A,{color:p[0].color,children:p[0].correlation}),(0,r.jsxs)("span",{children:["（",p[0].strength,p[0].direction,"）"]})]}),type:"info",showIcon:!0,style:{marginBottom:16}}),(0,r.jsx)("div",{style:{height:300},children:(0,r.jsx)(G.A,{...m})})]}):(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(x.A,{dataSource:p,columns:h,size:"small",pagination:!1}),(0,r.jsxs)("div",{style:{marginTop:16},children:[(0,r.jsx)("h4",{children:"变量选择建议："}),(0,r.jsxs)("ul",{children:[p.filter(e=>.2>Math.abs(e.correlation)).map(e=>(0,r.jsx)("li",{style:{color:"#666"},children:'变量 "'.concat(e.variable,'" 与因变量相关性较弱，可考虑删除')},e.variable)),p.filter(e=>Math.abs(e.correlation)>.7).map(e=>(0,r.jsx)("li",{style:{color:"#ff4d4f"},children:'变量 "'.concat(e.variable,'" 与因变量强相关，建议保留')},e.variable))]})]})]})]})}),(0,r.jsx)(i.A,{size:"small",title:"相关性说明",children:(0,r.jsxs)(o.A,{direction:"vertical",children:[(0,r.jsx)("div",{children:"• 相关系数范围：-1 到 1"}),(0,r.jsx)("div",{children:"• |r| ≥ 0.8：极强相关"}),(0,r.jsx)("div",{children:"• 0.6 ≤ |r| < 0.8：强相关"}),(0,r.jsx)("div",{children:"• 0.4 ≤ |r| < 0.6：中等相关"}),(0,r.jsx)("div",{children:"• 0.2 ≤ |r| < 0.4：弱相关"}),(0,r.jsx)("div",{children:"• |r| < 0.2：极弱相关或无相关"})]})})]}):(0,r.jsx)(P.A,{message:"没有有效的数据可供分析",type:"warning",showIcon:!0})};var T=n(21703),R=n(77203);let D=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"PEARSON",a=e.map(e=>parseFloat(e[t])).filter(e=>!isNaN(e)),i=e.map(e=>parseFloat(e[n])).filter(e=>!isNaN(e));if(a.length<2||i.length<2)return 0;try{switch(r){case"PEARSON":default:return function(e,t){let n=e.reduce((e,t)=>e+t)/e.length,r=t.reduce((e,t)=>e+t)/t.length;return e.reduce((e,a,i)=>e+(a-n)*(t[i]-r),0)/(Math.sqrt(e.reduce((e,t)=>e+Math.pow(t-n,2),0))*Math.sqrt(t.reduce((e,t)=>e+Math.pow(t-r,2),0)))}(a,i);case"SPEARMAN":return function(e,t){let n=e.length,r=O(e),a=O(t);return 1-6*r.map((e,t)=>e-a[t]).map(e=>e*e).reduce((e,t)=>e+t,0)/(n*(n*n-1))}(a,i);case"KENDALL":return function(e,t){let n=e.length,r=0,a=0;for(let i=0;i<n-1;i++)for(let o=i+1;o<n;o++){let n=Math.sign(e[o]-e[i]),l=Math.sign(t[o]-t[i]);0!==n&&0!==l&&(n===l?r++:a++)}let i=n*(n-1)/2;return 0===i?0:(r-a)/i}(a,i)}}catch(e){return console.error("Error calculating ".concat(r," correlation:"),e),0}};function O(e){return e.map((e,t)=>({value:e,index:t})).sort((e,t)=>e.value-t.value).map((e,t)=>({...e,rank:t+1})).sort((e,t)=>e.index-t.index).map(e=>e.rank)}let _=e=>e>=.5?{text:"高",color:"red"}:e>=.2?{text:"中",color:"orange"}:{text:"低",color:"green"},B=()=>{let{processedData:e,featureAnalysis:t}=g(),[n,a]=(0,u.useState)(t.independentVariables),l=(0,u.useMemo)(()=>t.dependentVariable&&(null==n?void 0:n.length)&&(null==e?void 0:e.length)?n.map(n=>{try{let r=D(e,t.dependentVariable,n),a=r?Math.pow(r,2):0;return{variable:n,importance:Number.isFinite(a)?Number(a.toFixed(4)):0,correlation:Number.isFinite(r)?Number(r.toFixed(4)):0}}catch(e){return console.error("Error calculating importance for ".concat(n,":"),e),{variable:n,importance:0,correlation:0}}}).sort((e,t)=>t.importance-e.importance):[],[e,t.dependentVariable,n]),d=[{title:"变量名称",dataIndex:"variable",key:"variable"},{title:"重要性得分 (R\xb2)",dataIndex:"importance",key:"importance",render:e=>(0,r.jsx)(o.A,{children:(0,r.jsx)(T.A,{percent:100*e,size:"small",format:e=>"".concat(null==e?void 0:e.toFixed(1),"%"),status:e>0?"normal":"exception",strokeColor:_(e).color})}),sorter:(e,t)=>t.importance-e.importance},{title:"重要性水平",key:"level",render:(e,t)=>{let n=_(t.importance);return(0,r.jsx)(E.A,{color:n.color,children:n.text})}},{title:"相关系数",dataIndex:"correlation",key:"correlation",render:e=>(0,r.jsxs)("span",{children:[e>0?"+":"",null==e?void 0:e.toFixed(3)]})}],c={data:l.length>0?l:[{variable:"无数据",importance:0}],xField:"variable",yField:"importance",meta:{variable:{alias:"变量名称"},importance:{alias:"重要性得分",min:0,max:1}},label:{position:"top",style:{fill:"#000000",opacity:.8},formatter:e=>(null==e?void 0:e.importance)||(null==e?void 0:e.importance)===0?"".concat((100*e.importance).toFixed(1),"%"):""},xAxis:{label:{autoRotate:!0,autoHide:!0,autoEllipsis:!0}},yAxis:{label:{formatter:e=>{let t=parseFloat(e);return Number.isFinite(t)?"".concat((100*t).toFixed(1),"%"):"0%"}},max:1,min:0},tooltip:{formatter:e=>{let t=null==e?void 0:e.importance;return Number.isFinite(t)?{name:"重要性得分",value:"".concat((100*t).toFixed(1),"%")}:{name:"重要性得分",value:"0%"}}},columnStyle:{fill:e=>_((null==e?void 0:e.importance)||0).color,radius:[4,4,0,0]}};return(0,r.jsx)(o.A,{direction:"vertical",style:{width:"100%"},children:(0,r.jsx)(i.A,{title:"变量重要性分析",children:(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(P.A,{message:"重要性分析说明",description:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"• 重要性得分基于R\xb2决定系数计算，范围：0-100%"}),(0,r.jsx)("p",{children:"• 得分越高表示该变量对因变量的影响越大"}),(0,r.jsx)("p",{children:"• 重要性水平：高(≥50%) 中(20-50%) 低(<20%)"})]}),type:"info",showIcon:!0}),(0,r.jsx)(s.A,{mode:"multiple",style:{width:"100%"},value:n,onChange:a,options:t.independentVariables.map(e=>({label:e,value:e})),placeholder:"选择要分析的自变量（可多选）",allowClear:!0}),l.length>0?(0,r.jsx)("div",{style:{height:300},children:(0,r.jsx)(R.A,{...c})}):(0,r.jsx)(P.A,{message:"暂无数据",description:"请选择要分析的变量",type:"info",showIcon:!0}),(0,r.jsx)(x.A,{dataSource:l,columns:d,size:"small",pagination:!1,rowKey:"variable"}),(0,r.jsx)(i.A,{size:"small",title:"变量选择建议",children:(0,r.jsx)("ul",{children:l.map(e=>(0,r.jsxs)("li",{style:{color:_(e.importance).color,marginBottom:8},children:[e.importance>=.5?"✨ ":e.importance>=.2?"\uD83D\uDC49 ":"⚠️ ",'变量 "'.concat(e.variable,'"'),e.importance>=.5?"对因变量有很强的解释力，建议保留":e.importance>=.2?"对因变量有一定解释力，可以考虑保留":"对因变量的解释力较弱，建议考虑删除"]},e.variable))})})]})})})},q=e=>{let{onNext:t}=e,{featureAnalysis:n,processedData:s}=g(),[d,c]=(0,u.useState)("correlation"),[p,m]=(0,u.useState)(!1),h=()=>{let{dependentVariable:e,independentVariables:t}=n;if(!e||!(null==t?void 0:t.length)||!(null==s?void 0:s.length)){a.Ay.error("数据不完整，请检查变量选择和数据");return}try{let n=s.filter(e=>e&&"object"==typeof e);if(!n.length){a.Ay.error("没有有效的数据行");return}if([e,...t].some(e=>n.map(t=>Number(t[e])).filter(e=>Number.isFinite(e)).length<2)){a.Ay.error("部分变量数据无效或数据点不足");return}m(!0)}catch(e){console.error("Analysis error:",e),a.Ay.error("分析过程中出现错误，请检查数据")}};return n.dependentVariable||0!==n.independentVariables.length?(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(M,{onAnalyze:h}),p&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{size:"small",children:(0,r.jsxs)(N.Ay.Group,{value:d,onChange:e=>c(e.target.value),buttonStyle:"solid",children:[(0,r.jsx)(N.Ay.Button,{value:"correlation",children:"相关性分析"}),(0,r.jsx)(N.Ay.Button,{value:"importance",children:"重要性分析"})]})}),"correlation"===d?(0,r.jsx)(V,{}):(0,r.jsx)(B,{}),(0,r.jsx)(l.Ay,{type:"primary",icon:(0,r.jsx)(b.A,{}),onClick:t,style:{marginTop:16},children:"继续分布检验"})]})]}):(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(M,{onAnalyze:h}),(0,r.jsx)(P.A,{message:"请选择变量并点击开始分析",type:"info",showIcon:!0})]})};var L=n(22810),U=n(2796),Y=n(89801),H=n(97295);let K=e=>{let t=e.length;if(t<3)return{mean:NaN,median:NaN,std:NaN,skewness:NaN,kurtosis:NaN,isNormal:!1,transformSuggestion:null};let n=e.reduce((e,t)=>e+t)/t,r=[...e].sort((e,t)=>e-t),a=t%2==0?(r[t/2-1]+r[t/2])/2:r[Math.floor(t/2)],i=Math.sqrt(e.reduce((e,t)=>e+Math.pow(t-n,2),0)/(t-1)),o=e.reduce((e,t)=>e+Math.pow((t-n)/i,3),0)/t,l=e.reduce((e,t)=>e+Math.pow((t-n)/i,4),0)/t-3,s=.5>Math.abs(o)&&.5>Math.abs(l),d=null;return!s&&(o>1?d="数据右偏，建议考虑对数转换 (log transformation)":o<-1?d="数据左偏，建议考虑指数转换 (exponential transformation)":l>1?d="数据分布较尖峰，建议考虑 Box-Cox 转换":l<-1&&(d="数据分布较平坦，建议考虑平方转换")),{mean:n,median:a,std:i,skewness:o,kurtosis:l,isNormal:s,transformSuggestion:d}},J=[{type:"log",label:"对数转换",description:"适用于右偏分布，压缩大值"},{type:"exp",label:"指数转换",description:"适用于左偏分布，压缩小值"},{type:"box-cox",label:"Box-Cox转换",description:"自动寻找最佳转换参数"},{type:"square",label:"平方转换",description:"增加数据差异"},{type:"sqrt",label:"平方根转换",description:"减小数据差异"},{type:"standardize",label:"标准化",description:"转换为均值0，标准差1"}],W=e=>{let{onTransformRequest:t}=e,{processedData:n,selectedColumns:d,distribution:p,setDistributionVariables:m,setProcessedData:h}=g(),[f,y]=(0,u.useState)(p.dependentVariable||""),[x,v]=(0,u.useState)(!1),[b,j]=(0,u.useState)(""),[A]=(0,u.useState)(""),[w,I]=(0,u.useState)(!1),k=(e,n)=>{let r=Q(n);t&&t(e,r)},F=()=>(0,r.jsx)(i.A,{size:"small",style:{marginBottom:16},children:(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(s.A,{placeholder:"选择因变量",style:{width:"100%"},value:p.dependentVariable,onChange:e=>m(e,p.independentVariables),options:d.map(e=>({label:e,value:e}))}),(0,r.jsx)(s.A,{mode:"multiple",placeholder:"选择自变量（可多选）",style:{width:"100%"},value:p.independentVariables,onChange:e=>m(p.dependentVariable,e),options:d.filter(e=>e!==p.dependentVariable).map(e=>({label:e,value:e}))})]})});if(!p.dependentVariable&&0===p.independentVariables.length)return(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[F(),(0,r.jsx)(P.A,{message:"请选择要分析的变量",type:"info",showIcon:!0})]});let N=e=>{let t=n.map(t=>Number(t[e])).filter(e=>!isNaN(e)),a=K(t),s=Math.min(20,Math.ceil(Math.sqrt(t.length))),d=Math.min(...t),c=(Math.max(...t)-d)/s,p=Array(s).fill(0).map((e,n)=>{let r=d+n*c,a=r+c,i=t.filter(e=>e>=r&&e<a).length;return{range:"".concat(r.toFixed(1),"-").concat(a.toFixed(1)),count:i,binStart:r,binEnd:a}}),u=Z(a);return(0,r.jsx)(i.A,{children:(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsxs)(L.A,{gutter:16,children:[(0,r.jsx)(U.A,{span:6,children:(0,r.jsx)(Y.A,{title:"平均值",value:a.mean.toFixed(2),prefix:(0,r.jsx)(S.A,{})})}),(0,r.jsx)(U.A,{span:6,children:(0,r.jsx)(Y.A,{title:"中位数",value:a.median.toFixed(2),prefix:(0,r.jsx)(S.A,{})})}),(0,r.jsx)(U.A,{span:6,children:(0,r.jsx)(Y.A,{title:"标准差",value:a.std.toFixed(2),prefix:(0,r.jsx)(S.A,{})})}),(0,r.jsx)(U.A,{span:6,children:(0,r.jsx)(E.A,{color:a.isNormal?"success":"warning",style:{padding:"5px 10px"},children:a.isNormal?"近似正态分布":"非正态分布"})})]}),(0,r.jsx)(P.A,{message:"分布形状特征：".concat(u.title),description:u.description,type:u.type,showIcon:!0}),(0,r.jsx)("div",{style:{height:300},children:(0,r.jsx)(R.A,{data:p,xField:"range",yField:"count",label:{position:"top",style:{fill:"#000000",opacity:.6,fontSize:12}},tooltip:{formatter:e=>({name:"频数",value:e.count})},columnStyle:{radius:[4,4,0,0],fill:a.isNormal?"#52c41a":"#faad14"},yAxis:{grid:{line:{style:{stroke:"#d9d9d9",lineDash:[4,4]}}}},xAxis:{label:{autoRotate:!0,autoHide:!0}}})}),a.transformSuggestion&&(0,r.jsx)(P.A,{message:"数据转换建议",description:(0,r.jsxs)(o.A,{direction:"vertical",children:[(0,r.jsx)("div",{children:a.transformSuggestion}),(0,r.jsx)(l.Ay,{type:"primary",onClick:()=>k(e,a),children:"前往数据预处理进行转换"})]}),type:"info",showIcon:!0})]})})},M=[p.dependentVariable,...p.independentVariables].map(e=>({label:e,key:e,children:N(e)}));return(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(P.A,{message:"分布检验说明",description:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:"直方图展示了数据的分布形状，柱子越高表示该区间的数据越多"}),(0,r.jsx)("li",{children:"绿色表示数据近似正态分布，黄色表示需要考虑数据转换"}),(0,r.jsx)("li",{children:"正态分布特征：钟形对称，中位数接近平均值"}),(0,r.jsx)("li",{children:"如果数据分布严重偏离正态，建议按照转换建议进行处理"})]}),type:"info",showIcon:!0}),F(),(0,r.jsx)(l.Ay,{type:"primary",icon:(0,r.jsx)(z.A,{}),onClick:()=>{let e=[p.dependentVariable,...p.independentVariables].filter(Boolean);if(e.some(e=>n.map(t=>Number(t[e])).filter(e=>!isNaN(e)).length<3)){a.Ay.error("部分变量数据点不足，无法进行分布分析");return}let t=Array.from(new Map(e.map(e=>{let t=n.map(t=>Number(t[e])).filter(e=>!isNaN(e));return[e,K(t)]})).entries()).filter(e=>{let[,t]=e;return!t.isNormal});t.length>0&&a.Ay.warning("发现 ".concat(t.length," 个变量分布不符合正态分布，请查看具体建议")),I(!0)},disabled:!p.dependentVariable&&0===p.independentVariables.length,style:{marginBottom:16},children:"开始分析"}),w&&(0,r.jsx)(c.A,{items:M,activeKey:f,onChange:y}),(0,r.jsx)(H.A,{title:"数据转换",open:x,onCancel:()=>v(!1),onOk:()=>{h(n.map(e=>({...e,[A]:X(Number(e[A]),b)}))),v(!1)},width:600,children:(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(P.A,{message:"正在转换变量: ".concat(A),type:"info",showIcon:!0}),(0,r.jsx)(s.A,{style:{width:"100%"},value:b,onChange:j,options:J.map(e=>({label:"".concat(e.label," - ").concat(e.description),value:e.type}))}),(0,r.jsxs)("div",{style:{marginTop:16},children:[(0,r.jsx)("h4",{children:"转换预览:"}),$(n,A,b)]})]})})]})},Z=e=>{let{skewness:t,kurtosis:n}=e;return .5>Math.abs(t)&&.5>Math.abs(n)?{title:"对称分布",description:"数据呈现良好的对称性，平均值和中位数接近，适合直接用于回归分析。",type:"success"}:t>.5?{title:"右偏分布",description:"数据分布向右倾斜，有较多大值，建议考虑对数转换。",type:"warning"}:t<-.5?{title:"左偏分布",description:"数据分布向左倾斜，有较多小值，建议考虑指数转换。",type:"warning"}:n>.5?{title:"尖峰分布",description:"数据过于集中，波动较大，建议考虑Box-Cox转换。",type:"warning"}:{title:"平坦分布",description:"数据分布较为分散，可能需要进行标准化处理。",type:"warning"}},Q=e=>e.skewness>1?"log":e.skewness<-1?"exp":e.kurtosis>1?"box-cox":Math.abs(e.mean)>10*e.std?"standardize":"log",X=(e,t)=>{switch(t){case"log":return Math.log(Math.max(e,1e-4));case"exp":return Math.exp(e);case"square":return e*e;case"sqrt":return Math.sqrt(Math.abs(e));default:return e}},$=(e,t,n)=>{let a=e.slice(0,5).map(e=>Number(e[t])),i=a.map(e=>X(e,n));return(0,r.jsxs)("table",{style:{width:"100%"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"原始值"}),(0,r.jsx)("th",{children:"转换后"})]})}),(0,r.jsx)("tbody",{children:a.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.toFixed(2)}),(0,r.jsx)("td",{children:i[t].toFixed(2)})]},t))})]})};var ee=n(51814),et=n(97139),en=n(83872);let er=(e,t)=>{if(!(null==e?void 0:e.length)){console.error("No data to export");return}try{let n=Object.keys(e[0]),r=[n.join(","),...e.map(e=>n.map(t=>{let n=e[t];return null==n?"":"string"==typeof n?/[,"\n\r]/.test(n)?'"'.concat(n.replace(/"/g,'""'),'"'):n:String(n)}).join(","))].join("\n"),a=new Blob(["\uFEFF"+r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");i.href=URL.createObjectURL(a),i.setAttribute("download",t),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(i.href)}catch(e){throw console.error("Export CSV error:",e),e}};var ea=n(38447);let ei=()=>{let{processedData:e}=g(),{addData:t}=(0,ea.D)(),{navigate:n}=(0,m.G)(),[s,d]=(0,u.useState)(!1),[c,p]=(0,u.useState)(!1),h=async()=>{if(!(null==e?void 0:e.length)){a.Ay.error("没有可保存的数据");return}try{d(!0),await en.C.init();let r=en.C.db.transaction([en.C.STORE_NAME],"readwrite").objectStore(en.C.STORE_NAME);await new Promise((e,t)=>{let n=r.clear();n.onsuccess=()=>e(),n.onerror=()=>t(n.error)}),await en.C.saveData(e),t(e),a.Ay.success("数据保存成功"),n("/data-management/")}catch(e){console.error("保存数据失败:",e),a.Ay.error("数据保存失败")}finally{d(!1)}},f=e[0]?Object.keys(e[0]).map(e=>({title:e,dataIndex:e,key:e})):[];return(0,r.jsxs)(o.A,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsx)(i.A,{children:(0,r.jsxs)(o.A,{style:{marginBottom:16},children:[(0,r.jsx)(l.Ay,{type:"primary",icon:(0,r.jsx)(ee.A,{}),onClick:h,loading:s,children:"保存数据"}),(0,r.jsx)(l.Ay,{icon:(0,r.jsx)(et.A,{}),onClick:()=>{if(!(null==e?void 0:e.length)){a.Ay.error("没有可导出的数据");return}try{p(!0);let t=e.slice(0,100);er(t,"regression_data_".concat(new Date().toISOString().split("T")[0],".csv")),a.Ay.success("数据导出成功")}catch(e){console.error("导出数据失败:",e),a.Ay.error("导出数据失败")}finally{p(!1)}},loading:c,children:"导出CSV"})]})}),(0,r.jsx)(x.A,{dataSource:e,columns:f,scroll:{x:!0},size:"small",pagination:{pageSize:10}})]})},eo=()=>{let{navigate:e}=(0,m.G)(),[t,n]=(0,u.useState)(!1),[f,x]=(0,u.useState)(null),[v,S]=(0,u.useState)(null),[b,A]=(0,u.useState)(y.DATA_SELECTION),{setRawData:w,selectedColumns:I,processedData:k,rawData:P}=g(),N=()=>{A({[y.DATA_SELECTION]:y.PREPROCESSING,[y.PREPROCESSING]:y.FEATURE_ANALYSIS,[y.FEATURE_ANALYSIS]:y.DISTRIBUTION,[y.DISTRIBUTION]:y.PREVIEW}[b]||b)},z=(0,u.useRef)(null),M=[{key:y.DATA_SELECTION,label:"选择数据列",children:(0,r.jsx)(j,{onNext:N}),disabled:!P.length},{key:y.PREPROCESSING,label:"数据预处理",children:(0,r.jsx)(F,{onNext:N}),disabled:!I.length},{key:y.FEATURE_ANALYSIS,label:"特征分析",children:(0,r.jsx)(q,{onNext:N}),disabled:!k.length},{key:y.DISTRIBUTION,label:"分布检验",children:(0,r.jsx)(W,{onTransformRequest:(e,t)=>{A(y.PREPROCESSING),z.current&&z.current.initiateTransform(e,t)}}),disabled:!k.length},{key:y.PREVIEW,label:"预览结果",children:(0,r.jsx)(ei,{}),disabled:!k.length}];return(0,r.jsx)(i.A,{title:(0,r.jsxs)(o.A,{children:[(0,r.jsx)(l.Ay,{icon:(0,r.jsx)(p.A,{}),type:"link",onClick:()=>e("/data-management/")}),(0,r.jsx)("span",{children:"数据接入"})]}),children:(0,r.jsxs)(o.A,{direction:"vertical",size:"large",style:{width:"100%"},children:[(0,r.jsxs)(o.A,{size:"large",children:[(0,r.jsx)(s.A,{placeholder:"选择科室",style:{width:200},options:[{value:"anesthesiology",label:"麻醉科"},{value:"surgery",label:"外科"},{value:"internal",label:"内科"}],onChange:e=>x(e)}),(0,r.jsx)(d.A.RangePicker,{style:{width:300},onChange:e=>S(e),placeholder:["开始日期","结束日期"]}),(0,r.jsx)(l.Ay,{type:"primary",onClick:()=>{if(!f||!v){a.Ay.error("请选择科室和时间范围");return}let[e,t]=v;n(!0),setTimeout(()=>{w(h.p),n(!1),a.Ay.success("成功获取 ".concat(e.format("YYYY-MM-DD")," 至 ").concat(t.format("YYYY-MM-DD")," 的数据"))},500)},loading:t,children:"获取数据"})]}),P.length>0&&(0,r.jsx)(c.A,{activeKey:b,items:M,onChange:e=>A(e)})]})})}},83872:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});class r{async init(){return new Promise((e,t)=>{let n=indexedDB.open(this.DB_NAME,1);n.onerror=()=>t(n.error),n.onsuccess=()=>{this.db=n.result,e()},n.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(this.STORE_NAME)||t.createObjectStore(this.STORE_NAME,{keyPath:"id",autoIncrement:!0})}})}async saveData(e){return this.db||await this.init(),new Promise((t,n)=>{let r=this.db.transaction([this.STORE_NAME],"readwrite"),a=r.objectStore(this.STORE_NAME);a.clear(),e.forEach(e=>{a.add(e)}),r.oncomplete=()=>t(),r.onerror=()=>n(r.error)})}async getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this.db||await this.init(),new Promise((t,n)=>{let r=this.db.transaction([this.STORE_NAME],"readonly").objectStore(this.STORE_NAME).openCursor(),a=[];r.onsuccess=n=>{let r=n.target.result;r&&a.length<e?(a.push(r.value),r.continue()):t(a)},r.onerror=()=>n(r.error)})}constructor(){this.db=null,this.STORE_NAME="processedData",this.DB_NAME="regressionDB"}}let a=new r},38447:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});let r=(0,n(99827).v)(e=>({dataList:[],addData:t=>e(e=>({dataList:[{id:"DAT".concat(new Date().getTime()),type:"处理后数据",department:"数据分析",recordTime:new Date().toLocaleString(),size:"".concat((JSON.stringify(t).length/1024).toFixed(1),"KB"),status:"已验证",data:t},...e.dataList]}))}))},40340:(e,t,n)=>{"use strict";n.d(t,{g:()=>l,y:()=>s});var r=n(95155),a=n(12115),i=n(76046);let o=(0,a.createContext)({isTransitioning:!1,startTransition:()=>{}});function l(e){let{children:t}=e,[n,l]=(0,a.useState)(!1),s=(0,i.usePathname)();return(0,a.useEffect)(()=>{let e=setTimeout(()=>{l(!1)},300);return()=>clearTimeout(e)},[s]),(0,r.jsx)(o.Provider,{value:{isTransitioning:n,startTransition:()=>{l(!0)}},children:t})}let s=()=>(0,a.useContext)(o)},6828:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});var r=n(76046),a=n(40340);function i(){let e=(0,r.useRouter)(),{startTransition:t}=(0,a.y)();return{navigate:n=>{t(),e.push(n)},replace:n=>{t(),e.replace(n)}}}}},e=>{var t=t=>e(e.s=t);e.O(0,[935,826,163,56,93,579,348,933,373,144,628,910,139,295,652,441,517,358],()=>t(67156)),_N_E=e.O()}]);