(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8505:(e,t,a)=>{Promise.resolve().then(a.bind(a,4211))},4211:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>R});var r=a(5155),i=a(2115),l=a(8280),s=a(9159),d=a.n(s),n=a(1379),o=a(9723),c=a(6742),u=a(8049),p=a(3809),m=a(42),f=a(212),x=a(7488),h=a(2516),g=a(9796),v=a(2570);class j{static calculateMean(e){return e.reduce((e,t)=>e+t)/e.length}static calculateVariance(e){let t=this.calculateMean(e);return e.reduce((e,a)=>e+Math.pow(a-t,2),0)/(e.length-1)}static matrixMultiply(e,t){let a=[];for(let r=0;r<e.length;r++){a[r]=[];for(let i=0;i<t[0].length;i++){let l=0;for(let a=0;a<t.length;a++)l+=e[r][a]*t[a][i];a[r][i]=l}}return a}static matrixInverse(e){let t=e.length,a=Array(t).fill(0).map((e,a)=>Array(t).fill(0).map((e,t)=>a===t?1:0)),r=e.map((e,t)=>[...e,...a[t]]);for(let e=0;e<t;e++){let a=Math.abs(r[e][e]),i=e;for(let l=e+1;l<t;l++)Math.abs(r[l][e])>a&&(a=Math.abs(r[l][e]),i=l);if(0===a)throw Error("Matrix is singular");i!==e&&([r[e],r[i]]=[r[i],r[e]]);for(let a=e+1;a<t;a++){let i=-r[a][e]/r[e][e];for(let l=e;l<2*t;l++)e===l?r[a][l]=0:r[a][l]+=i*r[e][l]}}for(let e=t-1;e>=0;e--)for(let a=e-1;a>=0;a--){let i=-r[a][e]/r[e][e];for(let l=0;l<2*t;l++)r[a][l]+=i*r[e][l]}for(let e=0;e<t;e++){let a=1/r[e][e];for(let i=0;i<2*t;i++)r[e][i]*=a}return r.map(e=>e.slice(t))}static tDistribution(e,t){let a=e/(e+Math.pow(t,2));return Math.sqrt(e*(1-a)/a)}static analyze(e,t,a){let r=e.length,i=e[0].length,l=e.map(e=>[1,...e]),s=t.map(e=>[e]),d=l[0].map((e,t)=>l.map(e=>e[t])),n=this.matrixMultiply(d,l),o=this.matrixInverse(n),c=this.matrixMultiply(d,s),u=this.matrixMultiply(o,c).map(e=>e[0]),p=u[0],m=u.slice(1),f=l.map(e=>e.reduce((e,t,a)=>e+t*u[a],0)),x=t.map((e,t)=>e-f[t]),h=this.calculateMean(t),g=t.reduce((e,t)=>e+Math.pow(t-h,2),0),v=x.reduce((e,t)=>e+Math.pow(t,2),0),j=1-v/g,y=1-(1-j)*(r-1)/(r-i-1),S=v/(r-i-1),b=u.map((e,t)=>Math.sqrt(S*o[t][t])),A=u.map((e,t)=>e/b[t]),I=A.map(e=>2*(1-this.tDistribution(r-i-1,Math.abs(e)))),M=(g-v)/i/(v/(r-i-1)),V=1-this.tDistribution(i,Math.sqrt(M)),w=0;for(let e=1;e<x.length;e++)w+=Math.pow(x[e]-x[e-1],2);let q=w/x.reduce((e,t)=>e+t*t,0),E=e[0].map((t,r)=>{let i=e.map(e=>e.filter((e,t)=>t!==r)),l=e.map(e=>e[r]);return 1/(1-this.analyze(i,l,a.filter((e,t)=>t!==r)).rSquared)}),z=this.tDistribution(r-i-1,.975),k=u.map((e,t)=>[e-z*b[t],e+z*b[t]]);return{coefficients:m,intercept:p,rSquared:j,adjustedRSquared:y,standardErrors:b.slice(1),tValues:A.slice(1),pValues:I.slice(1),fStatistic:M,fStatisticPValue:V,residuals:x,durbinWatson:q,vif:E,confidenceIntervals:k.slice(1).map(e=>[e[0],e[1]])}}}let y=e=>Number(e.toFixed(4)).toString();var S=a(3096),b=a(8367);let A=e=>{let{variableData:t,yAxisName:a}=e,[l,s]=(0,i.useState)(t.map(e=>e.variable)),d=e=>{var r;let i=(null===(r=t.find(t=>t.variable===e))||void 0===r?void 0:r.data)||[];return console.log("Plot data for ".concat(e,":"),i),{data:i,xField:"xValue",yField:"yValue",colorField:"variableName",size:5,shape:"circle",appendPadding:10,width:400,height:400,tooltip:{fields:["xValue","yValue","variableName"],title:"数据点详情"},xAxis:{title:{text:e},grid:{line:{style:{stroke:"#eee"}}},nice:!0},yAxis:{title:{text:a},grid:{line:{style:{stroke:"#eee"}}},nice:!0}}};return(0,r.jsx)(p.A,{title:"变量散点图分析 Variable Scatter Plots",children:(0,r.jsxs)(x.A,{gutter:[16,16],children:[(0,r.jsx)(h.A,{span:24,children:(0,r.jsx)(o.A,{mode:"multiple",style:{width:"100%"},placeholder:"选择要显示的变量",value:l,onChange:s,options:t.map(e=>({label:e.variable,value:e.variable}))})}),l.map(e=>{var a;return(0,r.jsx)(h.A,{span:12,children:(0,r.jsx)("div",{style:{height:450,border:"1px solid #f0f0f0",borderRadius:"2px",padding:"12px"},children:(null===(a=t.find(t=>t.variable===e))||void 0===a?void 0:a.data.length)?(0,r.jsx)(b.A,{...d(e)}):(0,r.jsx)(S.A,{description:"暂无数据"})})},e)})]})})},I={modelSummary:{title:"模型摘要 Model Summary",r:"相关系数 R",rSquared:"判定系数 R\xb2",adjustedRSquared:"调整的判定系数 Adjusted R\xb2",stdError:"估计的标准误差 Std. Error"},anova:{title:"方差分析表 ANOVA",source:"来源 Source",ss:"平方和 Sum of Squares",df:"自由度 df",ms:"均方 Mean Square",f:"F统计量 F-statistic",sig:"显著性 Sig."},coefficients:{title:"回归系数 Coefficients",variable:"变量 Variable",unstandardizedB:"非标准化系数 B",stdError:"标准误差 Std. Error",standardizedBeta:"标准化系数 Beta",tValue:"t值 t-value",sigValue:"显著性 Sig.",confidenceInterval:"95%置信区间 Confidence Interval",ciLower:"下限 Lower",ciUpper:"上限 Upper"}},M=e=>{let{data:t}=e,a=[{title:I.modelSummary.r,dataIndex:"r"},{title:I.modelSummary.rSquared,dataIndex:"rSquared"},{title:I.modelSummary.adjustedRSquared,dataIndex:"adjustedRSquared"},{title:I.modelSummary.stdError,dataIndex:"stdError"}],i=[{title:I.anova.source,dataIndex:"source"},{title:I.anova.ss,dataIndex:"ss"},{title:I.anova.df,dataIndex:"df"},{title:I.anova.ms,dataIndex:"ms"},{title:I.anova.f,dataIndex:"f"},{title:I.anova.sig,dataIndex:"sig"}],l=[{title:I.coefficients.variable,dataIndex:"variable"},{title:I.coefficients.unstandardizedB,dataIndex:"unstandardizedB"},{title:I.coefficients.stdError,dataIndex:"stdError"},{title:I.coefficients.standardizedBeta,dataIndex:"standardizedBeta"},{title:I.coefficients.tValue,dataIndex:"tValue"},{title:I.coefficients.sigValue,dataIndex:"sigValue"},{title:I.coefficients.confidenceInterval,children:[{title:I.coefficients.ciLower,dataIndex:"confidenceIntervalLower"},{title:I.coefficients.ciUpper,dataIndex:"confidenceIntervalUpper"}]}];return(0,r.jsx)("div",{style:{padding:24},children:(0,r.jsxs)(x.A,{gutter:[0,24],children:[(0,r.jsx)(h.A,{span:24,children:(0,r.jsx)(p.A,{title:"Model Summary",children:(0,r.jsx)(f.A,{dataSource:[t.modelSummary],columns:a,pagination:!1})})}),(0,r.jsx)(h.A,{span:24,children:(0,r.jsx)(p.A,{title:I.anova.title,children:(0,r.jsx)(f.A,{dataSource:t.anovaTable.rows,columns:i,pagination:!1})})}),(0,r.jsx)(h.A,{span:24,children:(0,r.jsx)(p.A,{title:I.coefficients.title,children:(0,r.jsx)(f.A,{dataSource:t.coefficients,columns:l,pagination:!1})})}),(0,r.jsx)(h.A,{span:24,children:(0,r.jsx)(A,{variableData:t.residualStats.variableScatterData,yAxisName:t.yAxisName})})]})})},{Option:V}=o.A,{Title:w,Text:q}=c.A,E=()=>{let[e,t]=(0,i.useState)([]),[a,s]=(0,i.useState)([]),[c,S]=(0,i.useState)(""),[b,A]=(0,i.useState)([]),[I,E]=(0,i.useState)(),[z,k]=(0,i.useState)(null),[R,F]=u.Ay.useMessage(),{getRootProps:N,getInputProps:C,isDragActive:B}=(0,l.VB)({onDrop:e=>{let a=e[0];k(a.name),d().parse(a,{header:!0,dynamicTyping:!0,complete:e=>{if(e.errors.length>0){R.error("文件解析失败，请检查文件格式。");return}let a=e.meta.fields||[];s(a),t(e.data.map(e=>a.map(t=>e[t]))),R.success("文件上传成功！")},error:()=>{R.error("文件解析失败，请检查文件格式。")}})}}),T=e.slice(0,100).map((e,t)=>{let r={key:t};return a.forEach((t,a)=>{r[t]=e[a]}),r});return(0,r.jsxs)("div",{style:{padding:"24px"},children:[F,(0,r.jsxs)(p.A,{title:"回归分析工具",bordered:!1,style:{boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)"},children:[(0,r.jsxs)("div",{...N(),style:{border:"2px dashed #1890ff",padding:"20px",textAlign:"center",borderRadius:"8px",cursor:"pointer",backgroundColor:B?"#e6f7ff":z?"#f6ffed":"#fff",borderColor:z?"#52c41a":"#1890ff"},children:[(0,r.jsx)("input",{...C()}),(0,r.jsx)(n.A,{style:{fontSize:"24px",color:z?"#52c41a":"#1890ff"}}),(0,r.jsx)("p",{children:z?"已上传文件: ".concat(z):B?"释放文件以上传":"拖拽或点击上传 CSV 文件"})]}),a.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{style:{marginTop:"24px"},items:[{key:"preview",label:"预览数据（前100条）",children:(0,r.jsx)(f.A,{dataSource:T,columns:a.map(e=>({title:e,dataIndex:e,key:e})),pagination:!1,scroll:{x:!0},size:"small"})}]}),(0,r.jsxs)("div",{style:{marginTop:"24px"},children:[(0,r.jsx)(w,{level:4,children:"选择变量"}),(0,r.jsxs)(x.A,{gutter:16,children:[(0,r.jsxs)(h.A,{span:12,children:[(0,r.jsx)(q,{strong:!0,children:"因变量:"}),(0,r.jsx)(o.A,{placeholder:"选择因变量",style:{width:"100%",marginTop:"8px"},value:c,onChange:e=>{if(b.includes(e)){R.warning('"'.concat(e,'" 已被选为自变量，不能同时作为因变量！'));return}S(e)},children:a.map(e=>(0,r.jsx)(V,{value:e,disabled:b.includes(e),children:(0,r.jsx)(g.A,{title:b.includes(e)?'"'.concat(e,'" 已被选为自变量，不能同时作为因变量！'):null,children:e})},e))})]}),(0,r.jsxs)(h.A,{span:12,children:[(0,r.jsx)(q,{strong:!0,children:"自变量:"}),(0,r.jsx)(o.A,{mode:"multiple",placeholder:"选择自变量",style:{width:"100%",marginTop:"8px"},value:b,onChange:e=>{if(e.includes(c)){R.warning('"'.concat(c,'" 已被选为因变量，不能同时作为自变量！'));return}A(e)},children:a.map(e=>(0,r.jsx)(V,{value:e,disabled:e===c,children:(0,r.jsx)(g.A,{title:e===c?'"'.concat(e,'" 已被选为因变量，不能同时作为自变量！'):null,children:e})},e))})]})]}),(0,r.jsx)(v.Ay,{type:"primary",onClick:()=>{if(!c||0===b.length){R.warning("请选择因变量和至少一个自变量！");return}let t=a.indexOf(c),r=b.map(e=>a.indexOf(e)),i=e.map(e=>r.map(t=>e[t])),l=e.map(e=>e[t]);E(function(e,t,a,r,i){let l=Math.sqrt(e.rSquared),s=i.length,d=t.length,n=i.reduce((e,t)=>e+t)/s,o=i.reduce((e,t)=>e+Math.pow(t-n,2),0),c=e.residuals.reduce((e,t)=>e+Math.pow(t,2),0),u=o-c,p=t.map((e,t)=>{let a=r.map((a,r)=>({variableName:e,xValue:Number(a[t].toFixed(4)),yValue:Number(i[r].toFixed(4)),index:r}));return console.log("Transformed data for ".concat(e,":"),a),{variable:e,data:a}}),m={rows:[{key:"regression",source:"回归 Regression",ss:y(u),df:d,ms:y(u/d),f:y(e.fStatistic),sig:y(e.fStatisticPValue)},{key:"residual",source:"残差 Residual",ss:y(c),df:s-d-1,ms:y(c/(s-d-1))},{key:"total",source:"总计 Total",ss:y(o),df:s-1,ms:"-"}]},f=t.map((t,a)=>({variable:t,unstandardizedB:y(e.coefficients[a]),stdError:y(e.standardErrors[a]),standardizedBeta:y(e.coefficients[a]*Math.sqrt(e.vif[a])),tValue:y(e.tValues[a]),sigValue:y(e.pValues[a]),confidenceIntervalLower:y(e.confidenceIntervals[a][0]),confidenceIntervalUpper:y(e.confidenceIntervals[a][1])}));return{modelSummary:{r:y(l),rSquared:y(e.rSquared),adjustedRSquared:y(e.adjustedRSquared),stdError:y(Math.sqrt(c/(s-d-1)))},anovaTable:m,coefficients:f,residualStats:{predictedValues:i.map((t,a)=>t-e.residuals[a]),predictedValuesFormatted:i.map((t,a)=>y(t-e.residuals[a])),residuals:e.residuals,residualsFormatted:e.residuals.map(e=>y(e)),standardizedResiduals:e.residuals.map(e=>e/Math.sqrt(c/(s-d-1))),standardizedResidualsFormatted:e.residuals.map(e=>y(e/Math.sqrt(c/(s-d-1)))),actual:i,variableScatterData:p},yAxisName:a}}(j.analyze(i,l,b),b,c,i,l))},style:{marginTop:"16px"},children:"执行回归分析"})]})]}),I&&(0,r.jsx)("div",{style:{marginTop:"24px"},children:(0,r.jsx)(M,{data:I})})]})]})};var z=a(2340);let k=()=>{let[e,t]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let e=!0;return requestAnimationFrame(()=>{setTimeout(()=>{e&&t(!1)},500)}),()=>{e=!1}},[]),(0,r.jsx)(z.Ay,{componentDisabled:e,children:(0,r.jsxs)("div",{style:{position:"relative",minHeight:"100vh"},children:[e&&(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(255, 255, 255, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999},children:"加载中..."}),(0,r.jsx)(E,{})]})})};function R(){return(0,r.jsx)(k,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[935,826,113,441,517,358],()=>t(8505)),_N_E=e.O()}]);