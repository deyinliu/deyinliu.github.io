(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[280],{17189:(e,a,t)=>{Promise.resolve().then(t.bind(t,5227))},5227:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>C});var s=t(95155),i=t(95203),r=t(99907),l=t(19445),n=t(57981),d=t(62704),c=t(12115),o=t(88280),u=t(29159),m=t.n(u),p=t(41379),h=t(2887),x=t(59845),f=t(1598),j=t(21614),v=t(46742),g=t(98133),y=t(94805),A=t(22810),S=t(2796),b=t(34810),I=t(72570);class M{static calculateMean(e){return e.reduce((e,a)=>e+a)/e.length}static calculateVariance(e){let a=this.calculateMean(e);return e.reduce((e,t)=>e+Math.pow(t-a,2),0)/(e.length-1)}static matrixMultiply(e,a){let t=[];for(let s=0;s<e.length;s++){t[s]=[];for(let i=0;i<a[0].length;i++){let r=0;for(let t=0;t<a.length;t++)r+=e[s][t]*a[t][i];t[s][i]=r}}return t}static matrixInverse(e){let a=e.length,t=Array(a).fill(0).map((e,t)=>Array(a).fill(0).map((e,a)=>t===a?1:0)),s=e.map((e,a)=>[...e,...t[a]]);for(let e=0;e<a;e++){let t=Math.abs(s[e][e]),i=e;for(let r=e+1;r<a;r++)Math.abs(s[r][e])>t&&(t=Math.abs(s[r][e]),i=r);if(0===t)throw Error("Matrix is singular");i!==e&&([s[e],s[i]]=[s[i],s[e]]);for(let t=e+1;t<a;t++){let i=-s[t][e]/s[e][e];for(let r=e;r<2*a;r++)e===r?s[t][r]=0:s[t][r]+=i*s[e][r]}}for(let e=a-1;e>=0;e--)for(let t=e-1;t>=0;t--){let i=-s[t][e]/s[e][e];for(let r=0;r<2*a;r++)s[t][r]+=i*s[e][r]}for(let e=0;e<a;e++){let t=1/s[e][e];for(let i=0;i<2*a;i++)s[e][i]*=t}return s.map(e=>e.slice(a))}static tDistribution(e,a){let t=e/(e+Math.pow(a,2));return Math.sqrt(e*(1-t)/t)}static analyze(e,a,t){let s=e.length,i=e[0].length,r=e.map(e=>[1,...e]),l=a.map(e=>[e]),n=r[0].map((e,a)=>r.map(e=>e[a])),d=this.matrixMultiply(n,r),c=this.matrixInverse(d),o=this.matrixMultiply(n,l),u=this.matrixMultiply(c,o).map(e=>e[0]),m=u[0],p=u.slice(1),h=r.map(e=>e.reduce((e,a,t)=>e+a*u[t],0)),x=a.map((e,a)=>e-h[a]),f=this.calculateMean(a),j=a.reduce((e,a)=>e+Math.pow(a-f,2),0),v=x.reduce((e,a)=>e+Math.pow(a,2),0),g=1-v/j,y=1-(1-g)*(s-1)/(s-i-1),A=v/(s-i-1),S=u.map((e,a)=>Math.sqrt(A*c[a][a])),b=u.map((e,a)=>e/S[a]),I=b.map(e=>2*(1-this.tDistribution(s-i-1,Math.abs(e)))),M=(j-v)/i/(v/(s-i-1)),N=1-this.tDistribution(i,Math.sqrt(M)),V=0;for(let e=1;e<x.length;e++)V+=Math.pow(x[e]-x[e-1],2);let w=V/x.reduce((e,a)=>e+a*a,0),q=e[0].map((a,s)=>{let i=e.map(e=>e.filter((e,a)=>a!==s)),r=e.map(e=>e[s]);return 1/(1-this.analyze(i,r,t.filter((e,a)=>a!==s)).rSquared)}),z=this.tDistribution(s-i-1,.975),E=u.map((e,a)=>[e-z*S[a],e+z*S[a]]);return{coefficients:p,intercept:m,rSquared:g,adjustedRSquared:y,standardErrors:S.slice(1),tValues:b.slice(1),pValues:I.slice(1),fStatistic:M,fStatisticPValue:N,residuals:x,durbinWatson:w,vif:q,confidenceIntervals:E.slice(1).map(e=>[e[0],e[1]])}}}let N=e=>Number(e.toFixed(4)).toString();var V=t(53096),w=t(28367);let q=e=>{let{variableData:a,yAxisName:t}=e,[r,l]=(0,c.useState)(a.map(e=>e.variable)),n=e=>{var s;let i=(null===(s=a.find(a=>a.variable===e))||void 0===s?void 0:s.data)||[];return console.log("Plot data for ".concat(e,":"),i),{data:i,xField:"xValue",yField:"yValue",colorField:"variableName",size:5,shape:"circle",appendPadding:10,width:400,height:400,tooltip:{fields:["xValue","yValue","variableName"],title:"数据点详情"},xAxis:{title:{text:e},grid:{line:{style:{stroke:"#eee"}}},nice:!0},yAxis:{title:{text:t},grid:{line:{style:{stroke:"#eee"}}},nice:!0}}};return(0,s.jsx)(i.A,{title:"变量散点图分析 Variable Scatter Plots",children:(0,s.jsxs)(A.A,{gutter:[16,16],children:[(0,s.jsx)(S.A,{span:24,children:(0,s.jsx)(j.A,{mode:"multiple",style:{width:"100%"},placeholder:"选择要显示的变量",value:r,onChange:l,options:a.map(e=>({label:e.variable,value:e.variable}))})}),r.map(e=>{var t;return(0,s.jsx)(S.A,{span:12,children:(0,s.jsx)("div",{style:{height:450,border:"1px solid #f0f0f0",borderRadius:"2px",padding:"12px"},children:(null===(t=a.find(a=>a.variable===e))||void 0===t?void 0:t.data.length)?(0,s.jsx)(w.A,{...n(e)}):(0,s.jsx)(V.A,{description:"暂无数据"})})},e)})]})})},z={modelSummary:{title:"模型摘要 Model Summary",r:"相关系数 R",rSquared:"判定系数 R\xb2",adjustedRSquared:"调整的判定系数 Adjusted R\xb2",stdError:"估计的标准误差 Std. Error"},anova:{title:"方差分析表 ANOVA",source:"来源 Source",ss:"平方和 Sum of Squares",df:"自由度 df",ms:"均方 Mean Square",f:"F统计量 F-statistic",sig:"显著性 Sig."},coefficients:{title:"回归系数 Coefficients",variable:"变量 Variable",unstandardizedB:"非标准化系数 B",stdError:"标准误差 Std. Error",standardizedBeta:"标准化系数 Beta",tValue:"t值 t-value",sigValue:"显著性 Sig.",confidenceInterval:"95%置信区间 Confidence Interval",ciLower:"下限 Lower",ciUpper:"上限 Upper"}},E=e=>{let{data:a}=e,t=[{title:z.modelSummary.r,dataIndex:"r"},{title:z.modelSummary.rSquared,dataIndex:"rSquared"},{title:z.modelSummary.adjustedRSquared,dataIndex:"adjustedRSquared"},{title:z.modelSummary.stdError,dataIndex:"stdError"}],r=[{title:z.anova.source,dataIndex:"source"},{title:z.anova.ss,dataIndex:"ss"},{title:z.anova.df,dataIndex:"df"},{title:z.anova.ms,dataIndex:"ms"},{title:z.anova.f,dataIndex:"f"},{title:z.anova.sig,dataIndex:"sig"}],l=[{title:z.coefficients.variable,dataIndex:"variable"},{title:z.coefficients.unstandardizedB,dataIndex:"unstandardizedB"},{title:z.coefficients.stdError,dataIndex:"stdError"},{title:z.coefficients.standardizedBeta,dataIndex:"standardizedBeta"},{title:z.coefficients.tValue,dataIndex:"tValue"},{title:z.coefficients.sigValue,dataIndex:"sigValue"},{title:z.coefficients.confidenceInterval,children:[{title:z.coefficients.ciLower,dataIndex:"confidenceIntervalLower"},{title:z.coefficients.ciUpper,dataIndex:"confidenceIntervalUpper"}]}];return(0,s.jsx)("div",{style:{padding:24},children:(0,s.jsxs)(A.A,{gutter:[0,24],children:[(0,s.jsx)(S.A,{span:24,children:(0,s.jsx)(i.A,{title:"Model Summary",children:(0,s.jsx)(y.A,{dataSource:[a.modelSummary],columns:t,pagination:!1})})}),(0,s.jsx)(S.A,{span:24,children:(0,s.jsx)(i.A,{title:z.anova.title,children:(0,s.jsx)(y.A,{dataSource:a.anovaTable.rows,columns:r,pagination:!1})})}),(0,s.jsx)(S.A,{span:24,children:(0,s.jsx)(i.A,{title:z.coefficients.title,children:(0,s.jsx)(y.A,{dataSource:a.coefficients,columns:l,pagination:!1})})}),(0,s.jsx)(S.A,{span:24,children:(0,s.jsx)(q,{variableData:a.residualStats.variableScatterData,yAxisName:a.yAxisName})})]})})},{Option:k}=j.A,{Title:R,Text:F}=v.A,B=()=>{let[e,a]=(0,c.useState)([]),[t,i]=(0,c.useState)([]),[r,n]=(0,c.useState)(""),[d,u]=(0,c.useState)([]),[v,V]=(0,c.useState)(),[w,q]=(0,c.useState)(null),[z,B]=g.Ay.useMessage(),{getRootProps:C,getInputProps:D,isDragActive:T}=(0,o.VB)({onDrop:e=>{let t=e[0];q(t.name),m().parse(t,{header:!0,dynamicTyping:!0,complete:e=>{if(e.errors.length>0){z.error("文件解析失败，请检查文件格式。");return}let t=e.meta.fields||[];i(t),a(e.data.map(e=>t.map(a=>e[a]))),z.success("文件上传成功！")},error:()=>{z.error("文件解析失败，请检查文件格式。")}})}}),_=e.slice(0,100).map((e,a)=>{let s={key:a};return t.forEach((a,t)=>{s[a]=e[t]}),s});return(0,s.jsxs)("div",{className:"analysis-content",children:[B,(0,s.jsxs)("div",{className:"analysis-section",children:[(0,s.jsxs)(R,{level:4,className:"section-title",children:[(0,s.jsx)(p.A,{className:"section-icon"}),"数据导入"]}),(0,s.jsxs)("div",{...C(),className:"upload-zone",style:{borderColor:w?"#52c41a":"#1890ff",background:T?"#e6f7ff":w?"#f6ffed":"#fafafa"},children:[(0,s.jsx)("input",{...D()}),(0,s.jsx)("p",{style:{margin:0},children:w?"当前文件: ".concat(w):T?"释放文件以上传":"拖拽CSV文件到此处或点击上传"})]})]}),t.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"analysis-section",children:[(0,s.jsxs)(R,{level:4,className:"section-title",children:[(0,s.jsx)(h.A,{className:"section-icon"}),"数据预览"]}),(0,s.jsx)(y.A,{dataSource:_,columns:t.map(e=>({title:e,dataIndex:e,key:e})),pagination:{pageSize:5},size:"small",scroll:{x:!0},className:"preview-table"})]}),(0,s.jsxs)("div",{className:"analysis-section",children:[(0,s.jsxs)(R,{level:4,className:"section-title",children:[(0,s.jsx)(x.A,{className:"section-icon"}),"变量选择"]}),(0,s.jsxs)(A.A,{gutter:[16,16],children:[(0,s.jsxs)(S.A,{span:12,children:[(0,s.jsx)(F,{strong:!0,children:"因变量:"}),(0,s.jsx)(j.A,{placeholder:"选择因变量",style:{width:"100%",marginTop:"8px"},value:r,onChange:e=>{if(d.includes(e)){z.warning('"'.concat(e,'" 已被选为自变量，不能同时作为因变量！'));return}n(e)},children:t.map(e=>(0,s.jsx)(k,{value:e,disabled:d.includes(e),children:(0,s.jsx)(b.A,{title:d.includes(e)?'"'.concat(e,'" 已被选为自变量，不能同时作为因变量！'):null,children:e})},e))})]}),(0,s.jsxs)(S.A,{span:12,children:[(0,s.jsx)(F,{strong:!0,children:"自变量:"}),(0,s.jsx)(j.A,{mode:"multiple",placeholder:"选择自变量",style:{width:"100%",marginTop:"8px"},value:d,onChange:e=>{if(e.includes(r)){z.warning('"'.concat(r,'" 已被选为因变量，不能同时作为自变量！'));return}u(e)},children:t.map(e=>(0,s.jsx)(k,{value:e,disabled:e===r,children:(0,s.jsx)(b.A,{title:e===r?'"'.concat(e,'" 已被选为因变量，不能同时作为自变量！'):null,children:e})},e))})]})]}),(0,s.jsx)(I.Ay,{type:"primary",onClick:()=>{if(!r||0===d.length){z.warning("请选择因变量和至少一个自变量！");return}let a=t.indexOf(r),s=d.map(e=>t.indexOf(e)),i=e.map(e=>s.map(a=>e[a])),l=e.map(e=>e[a]);V(function(e,a,t,s,i){let r=Math.sqrt(e.rSquared),l=i.length,n=a.length,d=i.reduce((e,a)=>e+a)/l,c=i.reduce((e,a)=>e+Math.pow(a-d,2),0),o=e.residuals.reduce((e,a)=>e+Math.pow(a,2),0),u=c-o,m=a.map((e,a)=>{let t=s.map((t,s)=>({variableName:e,xValue:Number(t[a].toFixed(4)),yValue:Number(i[s].toFixed(4)),index:s}));return console.log("Transformed data for ".concat(e,":"),t),{variable:e,data:t}}),p={rows:[{key:"regression",source:"回归 Regression",ss:N(u),df:n,ms:N(u/n),f:N(e.fStatistic),sig:N(e.fStatisticPValue)},{key:"residual",source:"残差 Residual",ss:N(o),df:l-n-1,ms:N(o/(l-n-1))},{key:"total",source:"总计 Total",ss:N(c),df:l-1,ms:"-"}]},h=a.map((a,t)=>({variable:a,unstandardizedB:N(e.coefficients[t]),stdError:N(e.standardErrors[t]),standardizedBeta:N(e.coefficients[t]*Math.sqrt(e.vif[t])),tValue:N(e.tValues[t]),sigValue:N(e.pValues[t]),confidenceIntervalLower:N(e.confidenceIntervals[t][0]),confidenceIntervalUpper:N(e.confidenceIntervals[t][1])}));return{modelSummary:{r:N(r),rSquared:N(e.rSquared),adjustedRSquared:N(e.adjustedRSquared),stdError:N(Math.sqrt(o/(l-n-1)))},anovaTable:p,coefficients:h,residualStats:{predictedValues:i.map((a,t)=>a-e.residuals[t]),predictedValuesFormatted:i.map((a,t)=>N(a-e.residuals[t])),residuals:e.residuals,residualsFormatted:e.residuals.map(e=>N(e)),standardizedResiduals:e.residuals.map(e=>e/Math.sqrt(o/(l-n-1))),standardizedResidualsFormatted:e.residuals.map(e=>N(e/Math.sqrt(o/(l-n-1)))),actual:i,variableScatterData:m},yAxisName:t}}(M.analyze(i,l,d),d,r,i,l))},style:{marginTop:"16px"},icon:(0,s.jsx)(l.A,{}),children:"执行回归分析"})]})]}),v&&(0,s.jsxs)("div",{className:"analysis-section",children:[(0,s.jsxs)(R,{level:4,className:"section-title",children:[(0,s.jsx)(f.A,{className:"section-icon"}),"分析结果"]}),(0,s.jsx)(E,{data:v})]})]})},C=()=>{let e=[{key:"regression",label:(0,s.jsxs)("span",{children:[(0,s.jsx)(l.A,{}),"回归分析"]}),children:(0,s.jsx)(B,{})},{key:"correlation",label:(0,s.jsxs)("span",{children:[(0,s.jsx)(n.A,{}),"相关性分析"]}),children:(0,s.jsx)("div",{children:"相关性分析模块开发中..."})},{key:"descriptive",label:(0,s.jsxs)("span",{children:[(0,s.jsx)(d.A,{}),"描述性统计"]}),children:(0,s.jsx)("div",{children:"描述性统计模块开发中..."})}];return(0,s.jsx)(i.A,{title:(0,s.jsxs)("span",{style:{fontSize:"18px",fontWeight:500},children:[(0,s.jsx)(d.A,{style:{marginRight:8}}),"数据分析工具集"]}),bordered:!1,className:"analysis-card",children:(0,s.jsx)(r.A,{defaultActiveKey:"regression",items:e,type:"card",size:"large",className:"analysis-tabs"})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[935,826,163,361,93,343,933,805,621,441,517,358],()=>a(17189)),_N_E=e.O()}]);